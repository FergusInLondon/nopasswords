# golangci-lint configuration for NoPasswords
# See https://golangci-lint.run/usage/configuration/

version: '2'

run:
  timeout: 5m
  go: '1.23'

linters:
  # Enable specific linters
  disable-all: true
  enable:
    - govet         # Reports suspicious constructs
    - gosec         # Security-focused linter
    - goconst       # Finds repeated strings that could be constants
    - revive        # Fast, configurable, extensible, flexible linter
    - unused        # Check for unused constants, variables, functions and types
    - gocyclo       # Computes cyclomatic complexity
  disable:
    - errcheck # This always runs!?

  settings:
    govet:
      # Enable all analyzers
      enable-all: true
      disable:
        - fieldalignment

    gocyclo:
      min-complexity: 20

    goconst:
      # Minimal length of string constant
      min-len: 3
      # Minimum occurrences of constant string count to trigger
      min-occurrences: 3

    gosec:
      # To select a subset of rules to run
      includes:
        - G401  # Detect use of weak cryptographic primitive
        - G402  # Look for bad TLS connection settings
        - G403  # Ensure minimum RSA key length of 2048 bits
        - G404  # Detect use of weak random number generator
        - G501  # Import blocklist: crypto/md5
        - G502  # Import blocklist: crypto/des
        - G503  # Import blocklist: crypto/rc4
        - G504  # Import blocklist: net/http/cgi
        - G505  # Import blocklist: crypto/sha1

      # Exclude generated files
      exclude-generated: true

    revive:
      # Enable all rules by default
      enable-all-rules: false
      rules:
        - name: exported
          severity: warning
          disabled: false
        - name: var-naming
          severity: warning
          disabled: false
        - name: package-comments
          severity: warning
          disabled: false
        - name: error-return
          severity: warning
          disabled: false
        - name: error-naming
          severity: warning
          disabled: false
        - name: if-return
          severity: warning
          disabled: false

  exclusions:
    rules:
    - linters:
        - govet
      text: 'shadow: declaration of "(err|ctx)" shadows declaration at'
    - path: _test\.go
      linters:
        - govet
        - gosec
        - goconst
        - revive
        - unused
        - gocyclo

issues:
  # Maximum issues count per one linter
  max-issues-per-linter: 0
  # Maximum count of issues with the same text
  max-same-issues: 0

output:
  # Format: colored-line-number|line-number|json|tab|checkstyle|code-climate
  format: colored-line-number

  # Print lines of code with issue
  print-issued-lines: true

  # Print linter name in the end of issue text
  print-linter-name: true
